<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tax Calculator Navigation Debug</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .status { padding: 10px; margin: 5px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
        .test-nav { background: #667eea; color: white; padding: 10px; margin: 10px; cursor: pointer; }
        .log { background: #f5f5f5; padding: 10px; margin: 10px 0; max-height: 200px; overflow-y: auto; }
    </style>
</head>
<body>
    <h1>🧮 Tax Calculator Navigation Debug</h1>
    
    <div class="debug-section">
        <h3>Issue Diagnosis:</h3>
        <p class="info"><strong>Problem:</strong> Navigation gives error on tax calculator page + blur effect when clicking</p>
        <p class="info"><strong>Expected:</strong> Navigation should work without errors and no blur effects</p>
    </div>
    
    <div class="debug-section">
        <h3>Test Navigation Functions:</h3>
        <button onclick="testNavigationClick()">🧪 Test Navigation Click</button>
        <button onclick="testBlurEffects()">🔍 Check Blur Effects</button>
        <button onclick="testOnclickHandlers()">⚡ Test Onclick Handlers</button>
        <button onclick="simulateTaxCalcNavigation()">🧮 Simulate Tax Calc Navigation</button>
    </div>
    
    <div class="debug-section">
        <h3>Test Navigation Items:</h3>
        <div class="test-nav" onclick="testNavClick('dashboard', '../index.html#dashboard')">📊 Dashboard</div>
        <div class="test-nav" onclick="testNavClick('calculator', '../index.html#calculator')">💰 Calculator</div>
        <div class="test-nav" onclick="testNavClick('calendar', 'calendar.html')">🗓️ Calendar View</div>
        <div class="test-nav" onclick="testNavClick('tax-calc', '#')">🧮 Tax Calculator (Active)</div>
    </div>
    
    <div class="debug-section">
        <h3>Debug Log:</h3>
        <div id="debugLog" class="log"></div>
    </div>
    
    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('debugLog');
            const div = document.createElement('div');
            div.className = 'status ' + type;
            div.innerHTML = `${new Date().toLocaleTimeString()}: ${message}`;
            logDiv.appendChild(div);
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function testNavigationClick() {
            log('🧪 Testing navigation click behavior...', 'info');
            
            try {
                // Test if navigation elements exist
                const navItems = document.querySelectorAll('.test-nav');
                log(`✅ Found ${navItems.length} test navigation items`, 'success');
                
                // Test click events
                navItems.forEach((item, index) => {
                    item.addEventListener('click', function(e) {
                        log(`📱 Navigation item ${index + 1} clicked: ${this.textContent}`, 'success');
                        
                        // Check for blur effects
                        const computedStyle = window.getComputedStyle(this);
                        const filter = computedStyle.filter;
                        const backdropFilter = computedStyle.backdropFilter || computedStyle.webkitBackdropFilter;
                        
                        if (filter && filter !== 'none') {
                            log(`❌ Filter detected: ${filter}`, 'error');
                        }
                        
                        if (backdropFilter && backdropFilter !== 'none') {
                            log(`❌ Backdrop filter detected: ${backdropFilter}`, 'error');
                        }
                        
                        if ((!filter || filter === 'none') && (!backdropFilter || backdropFilter === 'none')) {
                            log(`✅ No blur effects on navigation item`, 'success');
                        }
                    });
                });
                
            } catch (error) {
                log(`❌ Error testing navigation: ${error.message}`, 'error');
            }
        }
        
        function testBlurEffects() {
            log('🔍 Checking for blur effects...', 'info');
            
            // Check all elements for blur effects
            const allElements = document.querySelectorAll('*');
            let blurCount = 0;
            
            allElements.forEach(element => {
                const computedStyle = window.getComputedStyle(element);
                const filter = computedStyle.filter;
                const backdropFilter = computedStyle.backdropFilter || computedStyle.webkitBackdropFilter;
                
                if (filter && filter.includes('blur')) {
                    blurCount++;
                    log(`🔍 Blur filter found on ${element.tagName}.${element.className}: ${filter}`, 'info');
                }
                
                if (backdropFilter && backdropFilter.includes('blur')) {
                    blurCount++;
                    log(`🔍 Backdrop blur found on ${element.tagName}.${element.className}: ${backdropFilter}`, 'info');
                }
            });
            
            if (blurCount === 0) {
                log('✅ No blur effects found on page', 'success');
            } else {
                log(`⚠️ Found ${blurCount} elements with blur effects`, 'info');
            }
        }
        
        function testOnclickHandlers() {
            log('⚡ Testing onclick handlers...', 'info');
            
            // Test window.location.href functionality
            try {
                const testUrl = 'pages/tax-calculator.html';
                log(`🧪 Testing URL: ${testUrl}`, 'info');
                
                // Create a test function similar to tax calculator navigation
                const testHandler = function() {
                    log('📱 Onclick handler executed successfully', 'success');
                    log(`🔗 Would navigate to: ${testUrl}`, 'info');
                    
                    // Don't actually navigate, just test the function
                    // window.location.href = testUrl;
                };
                
                // Execute the test
                testHandler();
                
                log('✅ Onclick handler test passed', 'success');
                
            } catch (error) {
                log(`❌ Onclick handler error: ${error.message}`, 'error');
            }
        }
        
        function simulateTaxCalcNavigation() {
            log('🧮 Simulating tax calculator navigation...', 'info');
            
            // Simulate the exact navigation used in tax-calculator.html
            const navigationTests = [
                { name: 'Dashboard', url: '../index.html#dashboard' },
                { name: 'Calculator', url: '../index.html#calculator' },
                { name: 'Weekly Report', url: '../index.html#weekly' },
                { name: 'Calendar View', url: 'calendar.html' },
                { name: 'Shift Schedule', url: '../index.html#shifts' },
                { name: 'Settings', url: '../index.html#settings' }
            ];
            
            navigationTests.forEach(test => {
                try {
                    log(`🧪 Testing navigation to ${test.name} (${test.url})`, 'info');
                    
                    // Test URL validity
                    const url = new URL(test.url, window.location.href);
                    log(`✅ ${test.name} URL is valid: ${url.href}`, 'success');
                    
                    // Simulate the onclick behavior without actually navigating
                    const simulateOnclick = function() {
                        log(`📱 Simulated click on ${test.name}`, 'success');
                        // window.location.href = test.url; // Don't actually navigate
                    };
                    
                    simulateOnclick();
                    
                } catch (error) {
                    log(`❌ ${test.name} navigation error: ${error.message}`, 'error');
                }
            });
        }
        
        function testNavClick(pageName, url) {
            log(`📱 Test navigation clicked: ${pageName} → ${url}`, 'info');
            
            // Check if this would cause any issues
            try {
                if (url !== '#') {
                    const testUrl = new URL(url, window.location.href);
                    log(`✅ Navigation URL is valid: ${testUrl.href}`, 'success');
                    
                    // Open in new tab for testing
                    window.open(url, '_blank');
                    log(`🔗 Opened ${pageName} in new tab`, 'success');
                } else {
                    log(`📍 ${pageName} is the current page`, 'info');
                }
            } catch (error) {
                log(`❌ Navigation error for ${pageName}: ${error.message}`, 'error');
            }
        }
        
        // Auto-run tests on load
        window.addEventListener('load', function() {
            log('🚀 Tax calculator navigation debug loaded', 'info');
            
            // Auto-run basic tests
            setTimeout(() => {
                testNavigationClick();
                testBlurEffects();
            }, 500);
        });
        
        // Catch any JavaScript errors
        window.addEventListener('error', function(e) {
            log(`❌ JavaScript Error: ${e.message} at ${e.filename}:${e.lineno}`, 'error');
        });
        
        // Log when scripts load
        document.addEventListener('DOMContentLoaded', function() {
            log('📄 DOM Content Loaded', 'success');
        });
    </script>
</body>
</html>